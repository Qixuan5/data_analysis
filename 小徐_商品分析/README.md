# 小徐_商品分析:京东评论_城市消费偏好分析

## 📌 项目概述

本项目基于京东（JD.com）电商平台超过五万条真实用户评论数据，对比分析中国不同省市区域的消费偏好结构与“城市消费性格” 。通过 DrissionPage 爬虫技术获取用户评论 ，结合数据清洗、情感分析、RFM 模型、PCA 聚类、地理信息可视化及词云技术，构建城市消费画像，支持区域市场细分、品牌策略定位与用户体验优化决策 。



## 📁 文件结构

```
城市消费偏好分析/
├── data/                     # 抓取的原始评论数据与清洗结果
│   ├── 总评论final.xlsx
│   ├── province_stats.csv
│   └── job_cnt.csv
├── 京东评论.py                # 京东评论数据爬虫脚本 (基于 DrissionPage)
├── visualization.py          # 数据处理、分析与可视化脚本
├── china_provinces.geojson   # 中国省级地理信息数据
├── stopwords_zh.txt          # 中文停用词库
└── README.md                 # 当前说明文档

````


## 🌐 数据来源与抓取方法

* **平台**：京东 (JD.com) 商品评论区。
* **抓取方式**：
    * 使用 `requests` 库和正则表达式从京东搜索页批量抓取商品 SKU 列表。
    * 利用 `DrissionPage` 驱动 `Chromium` 浏览器访问商品详情页。
    * 通过模拟用户手动登录保留会话状态。
    * 模拟页面滚动以触发评论区加载。
    * 核心利用 `DrissionPage` 的网络监听功能，精确捕获加载评论数据的特定 Ajax 接口 (`pc_club_productPageComments`) 所返回的 JSON 数据包。
* **城市**：通过评论 `userProvince` (评论 IP) 字段识别用户所在省份。

### 📦 商品字段包括：

| 字段 | 描述 | 来源 |
| :--- | :--- | :--- |
| `sku` | 商品 ID | 商品页/搜索页 |
| `price` | 商品价格 | 商品页 |
| `nickname` | 用户昵称 | 评论 JSON |
| `userProvince` | 评论 IP (省份) | 评论 JSON |
| `productColor` | 购买颜色 | 评论 JSON |
| `score` | 评论分数 | 评论 JSON |
| `creationTime` | 评论时间 | 评论 JSON |
| `content` | 评论内容 | 评论 JSON |
| `is_plus` | 是否会员 | 评论 JSON |
| `imageCount` | 是否有图评论 | 评论 JSON |


## 🧼 数据清洗与处理

### 1. **数据读取与标准化**
    读取 Excel (`总评论final.xlsx`)。
    转换「评论时间」为 `datetime` 格式。
    标准化「评论IP」省份名称。

### 2. **情感计算**
    使用 `SnowNLP` 计算每条评论的情感得分（0-1）。
    按省份聚合计算平均情感分、正面评论比例等。

### 3. **RFM 指标计算**
    R (Recency)：计算各省近 30 天评论数。
    F (Frequency)：计算各省累计评论数。
    M (Monetary)：计算各省平均客单价。
    使用 `pd.qcut` 进行分箱打分。
    
### 4. **文本处理**
    使用 `jieba` 进行中文分词。
    加载停用词表进行过滤。



## 📊 可视化与建模

### 🌆 省级/区域分析图表

| 图表类型 | 内容 | 意图 |
| :--- | :--- | :--- |
| **热力图** | 省级评论量空间分布 | 识别消费活跃度集聚特征 |
| **热力图 (含柱形)** | 省级情感得分空间分布 | 识别满意度空间分异特征 |
| **蜂窝图** | 省级会员渗透率分布 | 分析用户粘性与会员经济接受度 |
| **热力图** | RFM 价值矩阵 | 对用户群体进行价值分层 |
| **网络图** | 省份-服装品类关联 | 挖掘省份与品类的关联强度 |
| **散点图** | PCA 聚类 (城市-关键词) | 识别相似消费关键词模式的城市群 |
| **散点图** | GDP/互联网普及率 vs 评论量 | 探究宏观因素对消费行为的影响 |

### 🏙 核心城市对比图表

| 图表 | 内容 | 用途 |
| :--- | :--- | :--- |
| **箱线图** | 京沪粤 vs Other 客单价分布 | 对比核心城市群的消费能力与结构 |
| **雷达图** | 京沪粤 vs Other (房价/工资/客单价) | 探讨经济基础对其消费行为的影响 |
| **词云图** | 京沪粤高频评论词 | 直观呈现核心城市消费者的关注焦点与诉求差异 |



## 🏆 核心发现与洞察

| 区域/城市 | 主力特征 | 词云/指标 | 消费性格描述 |
| :--- | :--- | :--- | :--- |
| **北京** | 品质驱动、形象导向 | “品质”、“通勤”、“大气”；房价、工资、客单价均高。 | **成熟引领型**：高收入、高标准，追求品质、形象与实用性。 |
| **上海** | 设计驱动、精致审美 | “精致”、“设计感”、“优雅”；房价、工资、客单价均高。 | **发达追随/新锐体验型**：时尚标杆，追求国际风格与高价值体验。 |
| **广东** | 性价比驱动、舒适实用 | “物美价廉”、“性价比高”、“舒服”；客单价相对偏低。 | **快速升级/潜力务实型**：务实、价格敏感，大众化、高周转。 |
| **东部沿海** | 电商成熟、满意度高 | 情感得分高（除广东），会员渗透率高。 | 消费结构成熟，购买力强，追求品质与服务。 |
| **西部地区** | 成长潜力、挑战并存 | 情感得分偏低，会员渗透率中低。 | 面临物流等挑战，但消费升级趋势明显，潜力待挖掘。 |
| **RFM 分群** | 价值分层 | 高 F3R3 (京沪粤等)、高 F1R1/F1R2 (云南新疆等)。 | 识别出“时尚引领核心型”、“目标导向潜力型”、“成长唤醒型”、“稳定价值驱动型”四种消费性格。 |
| **共通关注** | 品质与服务 | 对“满意度”、“好看”、“舒服”、“质量好”以及“物流快”、“客服”等普遍关注。 | 高效便捷的购物流程和良好的服务保障是共性关键因素。 |



## ⚙ 运行方式

### 安装依赖

```bash
pip install requests pandas matplotlib seaborn wordcloud jieba scikit-learn DrissionPage SnowNLP geopandas plotly networkx contextily adjustText
````

### 启动方式

```bash
# 1. 运行爬虫 (需手动登录)
python 京东评论.py

# 2. 运行分析与可视化 (确保数据文件存在)
python visualization.py --task all
```


## 📘 License

本项目遵循 MIT License，数据源来自京东公开接口，仅用于研究与教学使用，禁止商业用途。
