
# 小徐_房价分析

## 📌 项目概览

本项目旨在基于链家网公开的二手房挂牌数据，爬取并分析北京、上海、广州、深圳四个一线城市的房价结构与居住特征。通过数据爬虫获取明细房源信息，并结合地理编码、清洗与多维可视化，构建一个可量化、可扩展的城市住房分析框架，服务于城市规划、地产研究与公共政策评估。


## 📁 文件结构

```

小徐\_房价分析/
├── data/                         # 清洗后数据 & 可视化中间数据
├── get\_data\_yqx.py              # 链家网爬虫脚本（可迭代多城市）
├── clean\_data.py                # 数据清洗与字段标准化
├── geo\_code\_amap.py             # 高德API获取地理坐标
├── visualize\_price.py           # 房价可视化脚本（箱线图、热力图等）
├── visualize\_cluster.py         # 聚类分析与散点图输出
├── map\_plot.py                  # Pyecharts/Folium交互地图
└── README.md                    # 当前说明文档
```

## 🌐 数据来源与采集方法

- 数据网站：链家二手房 `https://{city}.lianjia.com/ershoufang/`
- 覆盖城市：北京、上海、广州、深圳
- 采集页数：每城市 100 页（约 3000 套房源）
- 字段数：列表页基础字段 + 详情页字段 + 标签字段，合计 43 项

### 🔧 技术栈与工具

| 模块           | 说明                                |
|----------------|-------------------------------------|
| `requests`     | 列表页爬取                          |
| `BeautifulSoup`| DOM 结构解析                        |
| `re`           | 正则解析字段                        |
| `csv`          | 数据写入                            |
| `time/random`  | 降低被封风险，设置爬取节奏          |
| `pandas`       | 数据清洗、转换与存储                |
| `folium` / `pyecharts` / `seaborn` | 可视化绘图工具 |


## 🧼 数据清洗流程

主要处理内容包括：

- 字段重命名与单位剥离（如“万”“元/平”）
- 正则拆分：楼层信息、区域拆分、抵押信息标准化
- 空值填补策略：例如“梯户比 = 无电梯”逻辑判断
- 经纬度获取：调用高德地图 Geo API，0.5 秒延迟控制请求频率
- 最终输出含 lat/lon 坐标字段的 CSV 文件，供地理热图使用


## 📊 可视化分析方法

### 🎯 一、连续变量分析
- 总价 / 单价 / 面积：箱线图、KDE分布、散点关系图、热力图
- 线性/非线性关系分析：使用 `pairplot` 与 `LOWESS` 拟合
- 聚类分析：`KMeans` 聚合客群（刚需 / 改善 / 豪宅）

### 📍 二、区级结构分析
- 房源数量、平均单价、平均总价的区际分布（条形图 + 地图）
- Choropleth 分级着色图，展示空间梯度
- 样例输出：`avg_price_map.html`、`price_heatmap.html`

### ⏱ 三、离散变量分析
- 分类变量频数：建筑类型、装修情况、楼层
- 月度挂牌趋势图（柱状图）
- 小区词云图（基于结巴分词 + WordCloud）

### 📈 四、多变量分析
- OLS 回归：解释总价的主要驱动因子
- 3D 散点图：面积-单价-梯户比 vs 总价
- 平行坐标图：四维特征轨迹可视化

### 🖱 五、交互可视化
- `folium`：单价热力图（HTML 输出）
- `plotly.express`：浮窗散点（面积 × 总价）
- `pyecharts.Map`：各区价格地图，支持滑动调节

## 🔁 城市横向对比分析亮点（以北京为例）

| 指标       | 北京样本解读 |
|------------|--------------|
| 单价结构   | 中位数 5.5 万元/㎡，极端值达 20 万元/㎡ |
| 总价分布   | 主力区间集中于 360–920 万，豪宅上限高达 2400 万 |
| 面积结构   | 中位数 115㎡，税收边界 144㎡起分段 |
| 聚类结果   | 明确划分刚需盘、改善盘与资产盘 |
| 政策效应   | 学区房溢价显著、限购造成面积“压制” |
| 区际梯度   | 海淀挂牌量高、西城单价顶级，空间结构高度分化 |

## 📝 运行说明

### 环境要求

```bash
pip install pandas requests beautifulsoup4 seaborn folium pyecharts plotly wordcloud
````

### 启动方式（以深圳为例）

```bash
# 1. 爬虫采集数据
python get_data_yqx.py

# 2. 数据清洗与地理编码
python clean_data.py

# 3. 可视化分析
python visualize_price.py
python visualize_cluster.py
python map_plot.py
```

## 📘 许可协议

本项目遵循 MIT License，欢迎 fork、引用、演示使用。数据仅用于课程与研究用途，禁止用于商业用途。



